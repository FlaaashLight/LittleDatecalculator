<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
body {
	font-size: medium;
	line-height: 1.8em;
	background: #f0f0f0;
	margin: 10px;
}

div {
	margin-bottom: 1em;
	text-align: left
}

a {
	white-space: nowrap;
}

.date {
	height: 2em;
	width: 12em;
}

.main {
	margin-left: 18em;
}
</style>

<title>日期计算器</title>
<body bgcolor="EEEEEE" style="" onload="loadold()">

	<div style="height:90px;">
		<!-- Date -->
		<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
		<script>
			function loadold() {
				var now = new Date();
				//格式化日，如果小于9，前面补0
				var day = ("0" + now.getDate()).slice(-2);
				//格式化月，如果小于9，前面补0
				var month = ("0" + (now.getMonth() + 1)).slice(-2);
				//格式化时，如果小于9，前面补0
				var hour = ("0" + now.getHours()).slice(-2);
				//格式化分，如果小于9，前面补0
				var min = ("0" + (now.getMinutes())).slice(-2);
				//拼装完整日期格式
				
				var today = now.getFullYear()+"-"+(month)+"-"+(day) ;
				var nowTime = (hour)+":"+(min) ;
				
				var temp = getCookie("dateTo");
				if (temp != "") {
					$("#dateTo").val(temp);
				} else {
					$('#dateTo').val(today);
				}
				temp = getCookie("dateFrom");
				if (temp != "") {
					$("#dateFrom").val(temp);
				} else {
					$('#dateFrom').val(today);
				}
				
				var temp = getCookie("timeTo");
				if (temp != "") {
					$("#timeTo").val(temp);
				} else {
					$('#timeTo').val(nowTime);
				}
				var temp = getCookie("timeFrom");
				if (temp != "") {
					$("#timeFrom").val(temp);
				} else {
					//$('#timeFrom').val(nowTime);
				}
			}

			function setCookie(cname, cvalue, exdays) {
				var d = new Date();
				d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
				var expires = "expires=" + d.toGMTString();
				document.cookie = cname + "=" + cvalue + ";" + expires
						+ ";path=/";
			}

			function getCookie(cname) {
				var name = cname + "=";
				var decodedCookie = decodeURIComponent(document.cookie);
				var ca = decodedCookie.split(';');
				for (var i = 0; i < ca.length; i++) {
					var c = ca[i];
					while (c.charAt(0) == ' ') {
						c = c.substring(1);
					}
					if (c.indexOf(name) == 0) {
						return c.substring(name.length, c.length);
					}
				}
				return "";
			}

			function cal() {
				var dateFrom = $("#dateFrom").val();
				var dateTo = $("#dateTo").val();
				var timeFrom = $("#timeFrom").val();
				var timeTo = $("#timeTo").val();

				setCookie("dateFrom", dateFrom, 30);
				setCookie("dateTo", dateTo, 30);
				setCookie("timeFrom", timeFrom, 30);
				setCookie("timeTo", timeTo, 30);
				
				var timeFromArray = $("#timeFrom").val().split(":");
				var timeToArray = $("#timeTo").val().split(":");
				
				var minDec = ((timeToArray[0] - timeFromArray[0]) * 60) + (timeToArray[1] - timeFromArray[1]) + "分钟";
				
				var dayDec = (new Date(dateTo) - new Date(dateFrom)) / 86400000 + "天";
				
				if (minDec == "0分钟") {
					minDec = "";
				}
				
				if (dayDec == "0天") {
					dayDec = "";
				}
				
				if (dayDec == "" && minDec == "") {
					dayDec = "就是现在！";
					$("#result").css("font-size", "50px");
				} else {
					$("#result").css("font-size","medium");
				}

				$("#result").html(dayDec + minDec);
			}
		</script>
	</div>
	
	<div class="main">
		<big>日期计算</big> 
		<br> 
		<a>从</a> 
		<br> 
		<input type="date" id="dateFrom" class="date" value=""/> 
		<input type="time" id="timeFrom" class="date" value="00:00"/> 
		<br> 
		<a>到</a> 
		<br> 
		<input type="date" id="dateTo" class="date" value=""> 
		<input type="time" id="timeTo" class="date" value="00:00"/> 
		<br> 
		<input type="button" value="相 差" onclick="cal()"> 
		<span id="result"></span>

	</div>
	<br>
</body>

</html>